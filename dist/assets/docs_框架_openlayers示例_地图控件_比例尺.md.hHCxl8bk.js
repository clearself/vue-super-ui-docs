import{C as v,a as x,g as C,c as T,e as M,M as b,V as w,T as q,d as L}from"./chunks/XYZ.ZtkXeE91.js";import{O as V}from"./chunks/OSM.yU6afTZH.js";import{d as N,a as W,o as P,e as S,f as D,aF as O,$ as U,g as B,j as $,V as A}from"./chunks/framework.54wzUQT-.js";const u="units",I=[1,2,5],g=25.4/.28;class R extends v{constructor(s){s=s||{};const e=document.createElement("div");e.style.pointerEvents="none",super({element:e,render:s.render,target:s.target}),this.on,this.once,this.un;const t=s.className!==void 0?s.className:s.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=t+"-inner",this.element.className=t+" "+x,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=s.minWidth!==void 0?s.minWidth:64,this.maxWidth_=s.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(u,this.handleUnitsChanged_),this.setUnits(s.units||"metric"),this.scaleBar_=s.bar||!1,this.scaleBarSteps_=s.steps||4,this.scaleBarText_=s.text||!1,this.dpi_=s.dpi||void 0}getUnits(){return this.get(u)}handleUnitsChanged_(){this.updateElement_()}setUnits(s){this.set(u,s)}setDpi(s){this.dpi_=s}updateElement_(){const s=this.viewState_;if(!s){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=s.center,t=s.projection,l=this.getUnits(),E=l=="degrees"?"degrees":"m";let a=C(t,s.resolution,e,E);const k=this.minWidth_*(this.dpi_||g)/g,p=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||g)/g:void 0;let n=k*a,i="";if(l=="degrees"){const c=M.degrees;n*=c,n<c/60?(i="″",a*=3600):n<c?(i="′",a*=60):i="°"}else l=="imperial"?n<.9144?(i="in",a/=.0254):n<1609.344?(i="ft",a/=.3048):(i="mi",a/=1609.344):l=="nautical"?(a/=1852,i="NM"):l=="metric"?n<.001?(i="μm",a*=1e6):n<1?(i="mm",a*=1e3):n<1e3?i="m":(i="km",a/=1e3):l=="us"?n<.9144?(i="in",a*=39.37):n<1609.344?(i="ft",a/=.30480061):(i="mi",a/=1609.3472):T(!1,33);let o=3*Math.floor(Math.log(k*a)/Math.log(10)),r,h,d,_,F,f;for(;;){d=Math.floor(o/3);const c=Math.pow(10,d);if(r=I[(o%3+3)%3]*c,h=Math.round(r/a),isNaN(h)){this.element.style.display="none",this.renderedVisible_=!1;return}if(p!==void 0&&h>=p){r=_,h=F,d=f;break}else if(h>=k)break;_=r,F=h,f=d,++o}const y=this.scaleBar_?this.createScaleBar(h,r,i):r.toFixed(d<0?-d:0)+" "+i;this.renderedHTML_!=y&&(this.innerElement_.innerHTML=y,this.renderedHTML_=y),this.renderedWidth_!=h&&(this.innerElement_.style.width=h+"px",this.renderedWidth_=h),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(s,e,t){const l=this.getScaleForResolution(),E=l<1?Math.round(1/l).toLocaleString()+" : 1":"1 : "+Math.round(l).toLocaleString(),a=this.scaleBarSteps_,k=s/a,p=[this.createMarker("absolute")];for(let i=0;i<a;++i){const o=i%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";p.push(`<div><div class="ol-scale-singlebar ${o}" style="width: ${k}px;"></div>`+this.createMarker("relative")+(i%2===0||a===2?this.createStepText(i,s,!1,e,t):"")+"</div>")}return p.push(this.createStepText(a,s,!0,e,t)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${s}px;">`+E+"</div>":"")+p.join("")}createMarker(s){return`<div class="ol-scale-step-marker" style="position: ${s}; top: ${s==="absolute"?3:-10}px;"></div>`}createStepText(s,e,t,l,E){const k=(s===0?0:Math.round(l/this.scaleBarSteps_*s*100)/100)+(s===0?"":" "+E),p=s===0?-3:e/this.scaleBarSteps_*-1,n=s===0?0:e/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${p}px;text-align: ${s===0?"left":"center"};min-width: ${n}px;left: ${t?e+"px":"unset"};">`+k+"</div>"}getScaleForResolution(){const s=C(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),e=this.dpi_||g,t=1e3/25.4;return s*t*e}render(s){const e=s.frameState;e?this.viewState_=e.viewState:this.viewState_=null,this.updateElement_()}}const j=R,H=N({__name:"scale",setup(m){const s=W();return P(()=>{new b({view:new w({center:[12579156,3274244],zoom:12}),layers:[new q({source:new V})],controls:L().extend([new j]),target:s.value})}),(e,t)=>(S(),D("div",{ref_key:"map",ref:s,class:"map-example"},null,512))}}),z=O(H,[["__scopeId","data-v-74f7948c"]]),G=A('<h1 id="openlayers-比例尺" tabindex="-1">openlayers 比例尺 <a class="header-anchor" href="#openlayers-比例尺" aria-label="Permalink to &quot;openlayers 比例尺&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">注意</p><p>地图图层使用 openlayers 自带 OSM，加载不出来需要开代理（<a href="https://b.tile.openstreetmap.org" target="_blank" rel="noreferrer">https://b.tile.openstreetmap.org</a>）</p></div>',2),J=A(`<details class="details custom-block"><summary>点击查看代码</summary><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;map&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;map-example&quot;</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { onMounted, ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/ol.css&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/Map&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> View </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/View&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TileLayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/layer/Tile&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OSM </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/source/OSM&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ScaleLine, defaults } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ol/control&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    view: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> View</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      center: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12579156</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3274244</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 坐标</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      zoom: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 放大倍数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    layers: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TileLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 创建一个使用Open Street Map地图源的瓦片图层</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        source: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OSM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    controls: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 地图默认控件 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScaleLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target: map.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scss&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scoped</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.map-example</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">vh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></details>`,1),Z=JSON.parse('{"title":"openlayers 比例尺","description":"","frontmatter":{},"headers":[],"relativePath":"docs/框架/openlayers示例/地图控件/比例尺.md","filePath":"docs/框架/openlayers示例/地图控件/比例尺.md","lastUpdated":1716277301000}'),K={name:"docs/框架/openlayers示例/地图控件/比例尺.md"},ss=Object.assign(K,{setup(m){return(s,e)=>{const t=U("ClientOnly");return S(),D("div",null,[G,B(t,null,{default:$(()=>[B(z)]),_:1}),J])}}});export{Z as __pageData,ss as default};
