import{E as F,al as X,am as Z,x as ee,r as J,u as te,w as le,an as ne,ao as ae,H as oe,ap as A,aq as se,K as re,ar as ce}from"./chunks/theme.gqej5HM7.js";import"./chunks/el-overlay.w40geAFS.js";import{d as K,e as r,f as g,E as V,g as v,j as T,J as U,G as $,i as I,I as G,y as N,A as H,v as E,F as O,D as L,aF as Y,a as b,w as Q,p as P,x as ie,n as M,W as ue,X as de,aD as B,b as pe,L as q,M as z,z as me,S as ve,$ as he}from"./chunks/framework.54wzUQT-.js";import"./chunks/el-input.w40geAFS.js";import"./chunks/el-icon.w40geAFS.js";import"./chunks/el-popper.w40geAFS.js";import"./chunks/el-popover.w40geAFS.js";import"./chunks/el-button.w40geAFS.js";import{T as _e}from"./chunks/Text.dT2Kgdrg.js";const fe={class:"new-chat"},ge={class:"list"},we={key:0},ye=["onClick"],Ve=["title"],ke=K({__name:"Aside",props:{chats:{type:Array,required:!0},modelValue:{type:Object}},emits:["update:modelValue","saveChats","delAll"],setup(h,{emit:_}){const e=h,n=_,c=s=>{e.modelValue===e.chats[s]&&n("update:modelValue"),e.chats.splice(s,1),n("saveChats")},y=s=>{s.cacheTitle=s.title,s.isEditing=!0},d=s=>{s.title=s.cacheTitle,s.isEditing=!1,delete s.cacheTitle,n("saveChats")},w=(s,l)=>new Date(s).getDate()-new Date(l).getDate(),i=s=>{const l=new Date(s).getFullYear(),t=String(new Date(s).getMonth()+1).padStart(2,"0"),p=String(new Date(s).getDate()).padStart(2,"0");return`${l}-${t}-${p}`};return(s,l)=>{const t=F,p=X,o=Z,m=ee,k=J,a=te,f=le,C=ne,D=ae;return r(),g("aside",null,[V("div",fe,[v(t,{text:"",icon:"el-icon-plus",onClick:l[0]||(l[0]=u=>n("update:modelValue"))},{default:T(()=>[U(" 新对话 ")]),_:1}),v(p,{title:"删除全部对话?",onConfirm:l[1]||(l[1]=u=>n("delAll"))},{reference:T(()=>[v(t,{class:"del-all",icon:"el-icon-delete",text:""})]),_:1})]),V("div",ge,[(r(!0),g($,null,I(h.chats,(u,x)=>{var R;return r(),g($,null,[w(u.time,(R=h.chats[x-1])==null?void 0:R.time)||x==0?(r(),g("time",we,G(i(u.time)),1)):N("",!0),V("ol",null,[V("li",{class:H(u===h.modelValue?"active":""),onClick:S=>n("update:modelValue",u)},[v(m,null,{default:T(()=>[v(o)]),_:1}),u.isEditing?(r(),E(k,{key:0,modelValue:u.cacheTitle,"onUpdate:modelValue":S=>u.cacheTitle=S,size:"small",autofocus:"",onClick:l[2]||(l[2]=O(()=>{},["stop"])),onKeydown:L(S=>d(u),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"])):(r(),g("p",{key:1,class:"ellipsis",title:u.title},G(u.title),9,Ve)),V("div",{class:"control",onClick:l[3]||(l[3]=O(()=>{},["stop"]))},[u.isEditing?(r(),g($,{key:0},[v(m,null,{default:T(()=>[v(a,{onClick:S=>d(u)},null,8,["onClick"])]),_:2},1024),v(m,null,{default:T(()=>[v(f,{onClick:S=>u.isEditing=!1},null,8,["onClick"])]),_:2},1024)],64)):(r(),g($,{key:1},[v(m,null,{default:T(()=>[v(C,{onClick:S=>y(u)},null,8,["onClick"])]),_:2},1024),v(m,null,{default:T(()=>[v(D,{onClick:S=>c(x)},null,8,["onClick"])]),_:2},1024)],64))])],10,ye)])],64)}),256))])])}}}),j=Y(ke,[["__scopeId","data-v-52c146d4"]]),Ce={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"2",viewBox:"0 0 16 16"},Te=V("path",{fill:"currentColor",d:"M.5 1.163A1 1 0 0 1 1.97.28l12.868 6.837a1 1 0 0 1 0 1.766L1.969 15.72A1 1 0 0 1 .5 14.836V10.33a1 1 0 0 1 .816-.983L8.5 8 1.316 6.653A1 1 0 0 1 .5 5.67z"},null,-1),$e=[Te];function be(h,_){return r(),g("svg",Ce,[...$e])}const Se={render:be},xe="/vue-super-ui/assets/chatGPT.pVqd4NQg.svg",Pe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-4 w-4",viewBox:"0 0 24 24"},Ee=V("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"},null,-1),De=V("path",{d:"M9 3v18"},null,-1),Ae=[Ee,De];function Ie(h,_){return r(),g("svg",Pe,[...Ae])}const Ge={render:Ie},Me="/vue-super-ui/assets/avatar.ggKGey9c.png";function Ne(h){let _,e,n,c,y,d,w;return i(),{feed:s,reset:i};function i(){_=!0,e="",n=0,c=-1,y=void 0,d=void 0,w=""}function s(t){e=e?e+t:t,_&&Oe(e)&&(e=e.slice(W.length)),_=!1;const p=e.length;let o=0,m=!1;for(;o<p;){m&&(e[o]===`
`&&++o,m=!1);let k=-1,a=c,f;for(let C=n;k<0&&C<p;++C)f=e[C],f===":"&&a<0?a=C-o:f==="\r"?(m=!0,k=C-o):f===`
`&&(k=C-o);if(k<0){n=p-o,c=a;break}else n=0,c=-1;l(e,o,a,k),o+=k+1}o===p?e="":o>0&&(e=e.slice(o))}function l(t,p,o,m){if(m===0){w.length>0&&(h({type:"event",id:y,event:d||void 0,data:w.slice(0,-1)}),w="",y=void 0),d=void 0;return}const k=o<0,a=t.slice(p,p+(k?m:o));let f=0;k?f=m:t[p+o+1]===" "?f=o+2:f=o+1;const C=p+f,D=m-f,u=t.slice(C,C+D).toString();if(a==="data")w+=u?"".concat(u,`
`):`
`;else if(a==="event")d=u;else if(a==="id"&&!u.includes("\0"))y=u;else if(a==="retry"){const x=parseInt(u,10);Number.isNaN(x)||h({type:"reconnect-interval",value:x})}}}const W=[239,187,191];function Oe(h){return W.every((_,e)=>h.charCodeAt(e)===_)}const Ke=async(h,_,e,n)=>{const c=new TextDecoder,y=await fetch(h,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({model:n,token:0,user_id:0,msg:_})});if(y.status!==200)throw new Error("OpenAI API returned an error");return new ReadableStream({async start(d){const w=y.body.getReader(),s=Ne(l=>{try{if(l.type==="event"){const t=l.data,p=JSON.parse(t);if(!p.choices[0])return;if(p.choices[0].finish_reason==="stop"){d.close();return}const o=p.choices[0].delta.content||"";d.enqueue(o)}}catch(t){console.log(t,"error")}});for(;;){const{done:l,value:t}=await w.read();if(l)break;t&&s.feed(c.decode(t))}}})},Ue=async({msg:h,props:_,emits:e,message:n,inputVal:c})=>{const d=(await Ke(`${oe}/gpt`,n.map(w=>({content:w.content,role:w.role})),"",_.modelValue.model)).getReader();for(;;){const{done:w,value:i}=await d.read();if(w){e("saveChats");break}h.value.content+=i}},Re=h=>(ue("data-v-a20376cc"),h=h(),de(),h),Be=["innerHTML"],qe={key:1,class:"welcome"},ze=Re(()=>V("h1",null,"GPT",-1)),je={class:"list"},Fe={class:"input-container"},Je=K({__name:"Main",props:{chats:{},modelValue:{},drawer:{type:Boolean},currentModel:{}},emits:["update:modelValue","update:drawer","saveChats"],setup(h,{emit:_}){const e=h,n=_,c=b(""),y=async t=>{var a;if(t.ctrlKey||t.altKey||t.shiftKey){const f=d.value.$el.querySelector("textarea"),C=f.selectionStart,D=f.selectionEnd;c.value=c.value.substring(0,C)+`
`+c.value.substring(D);const u=C+1;await M(()=>{f.setSelectionRange(u,u)});return}if(!c.value.trim().length)return;const p={role:"system",content:`现在时间:${Date.now()}`};if(!e.modelValue){const f={model:e.currentModel,time:Date.now(),title:c.value.slice(0,15),message:[p]};e.chats.unshift(f),n("update:modelValue",f),await M()}(a=e.modelValue)==null||a.message.push({role:"user",content:c.value.replace(/(\n)(?![^`]*```)/g,`

`)});const o=e.modelValue.message.slice(-3);o[0]!==e.modelValue.message[0]&&o.unshift(e.modelValue.message[0]);const m=b({role:"assistant",content:"",loading:!0});e.modelValue.message.push(m.value),n("saveChats");const k=c.value.trim();c.value="";try{await Ue({inputVal:k,msg:m,props:e,emits:n,message:o})}catch{m.value.error=!0}finally{m.value.loading=!1,n("saveChats")}},d=b(),w=t=>{c.value=t,d.value.focus()},i=b(),s=async()=>{var t;await M(),(t=i.value)==null||t.scrollTo({top:i.value.scrollHeight,behavior:"smooth"})};Q([()=>{var t;return(t=e.modelValue)==null?void 0:t.time},()=>{var t;return(t=e.modelValue)==null?void 0:t.message.length}],s);const l=[{title:"",children:[{label:'"用简单的术语解释一下量子计算" →',value:"用简单的术语解释一下量子计算"},{label:'"使用axios发送http请求" →',value:"使用axios发送http请求"},{label:'"鲁迅与周树人是什么关系？" →',value:"鲁迅与周树人是什么关系？"}]}];return(t,p)=>{const o=se,m=F,k=J;return r(),g("main",null,[t.modelValue?(r(),g("ol",{key:t.modelValue.time,class:"answers",ref_key:"olRef",ref:i},[(r(!0),g($,null,I(t.modelValue.message,a=>(r(),g($,null,[a.role!=="system"?(r(),g("li",{key:0,class:H(a.role)},[V("div",null,[v(o,{src:a.role==="assistant"?P(xe):P(Me),shape:"square",size:24},null,8,["src"]),a.role==="assistant"?(r(),E(_e,{key:0,text:a.content,error:a.error,loading:a.loading,onEnd:f=>a.loading=!1},null,8,["text","error","loading","onEnd"])):(r(),g("div",{key:1,class:"content",innerHTML:a.content},null,8,Be))])],2)):N("",!0)],64))),256))])):(r(),g("div",qe,[ze,V("div",je,[(r(),g($,null,I(l,a=>V("ul",null,[V("h2",null,G(a.title),1),(r(!0),g($,null,I(a.children,f=>(r(),g("li",null,[v(m,{text:"",bg:"",onClick:C=>w(f.value)},{default:T(()=>[U(G(f.label),1)]),_:2},1032,["onClick"])]))),256))])),64))])])),V("div",Fe,[v(k,{modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=a=>c.value=a),ref_key:"inputRef",ref:d,type:"textarea",resize:"none",autosize:{minRows:1,maxRows:8},placeholder:"发送一个消息",onKeydown:L(O(y,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),v(m,{type:"primary",icon:P(Se),disabled:!c.value,onClick:y},null,8,["icon","disabled"])]),t.modelValue?(r(),E(m,{key:2,class:"scroll-to-end",circle:"",icon:"el-icon-bottom",onClick:s})):N("",!0),(r(),E(ie(P(A)?"span":"el-tooltip"),{effect:"dark",content:t.drawer?"关闭侧边栏":"打开侧边栏",placement:"right"},{default:T(()=>[v(m,{bg:"",text:"",class:"close-aside",onClick:p[1]||(p[1]=a=>n("update:drawer",!t.drawer))},{default:T(()=>[v(P(Ge))]),_:1})]),_:1},8,["content"]))])}}}),He=Y(Je,[["__scopeId","data-v-a20376cc"]]),Le={class:"chatGPT-container"},Ye=K({__name:"chatGPT",setup(h){const _=b(JSON.parse(localStorage.getItem("chatGPT-chats"))||[]),e=()=>{localStorage.setItem("chatGPT-chats",JSON.stringify(_.value))};B&&(window.copyToClip=function(w){setTimeout(()=>{const i=w.nextElementSibling.nextElementSibling.textContent;re(i)},200)}),pe(()=>{B&&delete window.copyToClip}),ve("chats",_);const n=b(),c=b("gpt-3.5-turbo"),y=()=>{_.value=[],n.value=void 0},d=b(!A.value);return Q(A,()=>{d.value=!0}),(w,i)=>{const s=ce;return r(),g("div",Le,[P(A)?(r(),E(s,{key:0,modelValue:d.value,"onUpdate:modelValue":i[2]||(i[2]=l=>d.value=l),direction:"ltr","show-close":!1,"with-header":!1,"custom-class":"drawer-chatgpt",size:"auto","lock-scroll":""},{default:T(()=>[q(v(j,{modelValue:n.value,"onUpdate:modelValue":[i[0]||(i[0]=l=>n.value=l),i[1]||(i[1]=l=>d.value=!1)],chats:_.value,"current-model":c.value,onSaveChats:e,onDelAll:y},null,8,["modelValue","chats","current-model"]),[[z,d.value]])]),_:1},8,["modelValue"])):(r(),E(me,{key:1,name:"slideInOut"},{default:T(()=>[q(v(j,{modelValue:n.value,"onUpdate:modelValue":i[3]||(i[3]=l=>n.value=l),chats:_.value,"current-model":c.value,onSaveChats:e,onDelAll:y},null,8,["modelValue","chats","current-model"]),[[z,d.value]])]),_:1})),v(He,{modelValue:n.value,"onUpdate:modelValue":i[4]||(i[4]=l=>n.value=l),drawer:d.value,"onUpdate:drawer":i[5]||(i[5]=l=>d.value=l),chats:_.value,"current-model":c.value,onSaveChats:e},null,8,["modelValue","drawer","chats","current-model"])])}}}),Qe=V("h1",{style:{display:"none"},id:"chatgpt",tabindex:"-1"},[U("chatGPT "),V("a",{class:"header-anchor",href:"#chatgpt","aria-label":'Permalink to "chatGPT{style="display: none"}"'},"​")],-1),rt=JSON.parse('{"title":"chatGPT","description":"","frontmatter":{"class":"chatGPT","layout":"doc","footer":false,"aside":false,"sidebar":false},"headers":[],"relativePath":"pages/chatGPT.md","filePath":"pages/chatGPT.md","lastUpdated":1716277301000}'),We={name:"pages/chatGPT.md"},ct=Object.assign(We,{setup(h){return(_,e)=>{const n=he("ClientOnly");return r(),g("div",null,[v(n,null,{default:T(()=>[v(Ye)]),_:1}),Qe])}}});export{rt as __pageData,ct as default};
