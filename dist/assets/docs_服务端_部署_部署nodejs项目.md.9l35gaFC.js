import{aF as s,e as i,f as a,V as e}from"./chunks/framework.54wzUQT-.js";const u=JSON.parse('{"title":"服务器运行 nodejs 项目","description":"","frontmatter":{},"headers":[],"relativePath":"docs/服务端/部署/部署nodejs项目.md","filePath":"docs/服务端/部署/部署nodejs项目.md","lastUpdated":1716277301000}'),t={name:"docs/服务端/部署/部署nodejs项目.md"},l=e(`<h1 id="服务器运行-nodejs-项目" tabindex="-1">服务器运行 nodejs 项目 <a class="header-anchor" href="#服务器运行-nodejs-项目" aria-label="Permalink to &quot;服务器运行 nodejs 项目&quot;">​</a></h1><h2 id="安装-lrzsz-上传文件到服务器" tabindex="-1">安装 lrzsz 上传文件到服务器 <a class="header-anchor" href="#安装-lrzsz-上传文件到服务器" aria-label="Permalink to &quot;安装 lrzsz 上传文件到服务器&quot;">​</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-yuD7L" id="tab-JsY3uQ1" checked="checked"><label for="tab-JsY3uQ1">Ubuntu</label><input type="radio" name="group-yuD7L" id="tab-Jw5T9qG"><label for="tab-Jw5T9qG">CentOS</label></div><div class="blocks"><div class="language-sh vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get install lrzsz  # 对于基于 Debian 的系统，如 Ubuntu</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum install lrzsz  # 对于基于 CentOS/RHEL 的系统</span></span></code></pre></div></div></div><p>安装完成后，您可以使用以下步骤进行文件上传：</p><ol><li>在本地计算机上，打开终端。</li><li>使用 rz 命令选择要上传的文件</li><li>在选择文件后，文件将被上传到远程服务器的当前目录。</li></ol><div class="tip custom-block"><p class="custom-block-title">注意</p><p>如果您的目标是从本地计算机上传文件到服务器，更常见且便捷的方法是使用 scp 命令。scp 命令可以直接在本地计算机上使用，无需在服务器上运行额外的命令。</p></div><h2 id="安装-unzip-解压文件" tabindex="-1">安装 unzip 解压文件 <a class="header-anchor" href="#安装-unzip-解压文件" aria-label="Permalink to &quot;安装 unzip 解压文件&quot;">​</a></h2><p>一般项目会打包成压缩包，使用 unzip 解压文件</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-G7n3r" id="tab-mTLqHLx" checked="checked"><label for="tab-mTLqHLx">Ubuntu/Debian</label><input type="radio" name="group-G7n3r" id="tab-Yj4VPoI"><label for="tab-Yj4VPoI">CentOS/RHEL</label><input type="radio" name="group-G7n3r" id="tab-p59_4WW"><label for="tab-p59_4WW">Fedora</label><input type="radio" name="group-G7n3r" id="tab-PCzbUYZ"><label for="tab-PCzbUYZ">openSUSE</label></div><div class="blocks"><div class="language-sh vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get install unzip</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum install unzip</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dnf install unzip</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zypper install unzip</span></span></code></pre></div></div></div><p>安装完成后，可以在服务器上使用 unzip 命令来解压缩 zip 文件了</p><h2 id="安装-nvm-管理-nodejs-版本" tabindex="-1">安装 nvm 管理 nodejs 版本 <a class="header-anchor" href="#安装-nvm-管理-nodejs-版本" aria-label="Permalink to &quot;安装 nvm 管理 nodejs 版本&quot;">​</a></h2><p>NVM 是一个方便的工具，可以帮助你在同一台机器上管理和切换不同版本的 Node.js。</p><ol><li>安装 NVM</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span></span></code></pre></div><ol start="2"><li>安装完成后，重启终端或运行以下命令使 NVM 变为可用</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span></code></pre></div><ol start="3"><li>安装新版本的 Node.js</li></ol><p>通过 NVM，你可以安装任何你想要的 Node.js 版本。以下是安装最新 LTS 版本的示例：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install --lts</span></span></code></pre></div><p>可以使用以下命令，将 X.Y.Z 替换为你想要的版本号</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install X.Y.Z</span></span></code></pre></div><ol start="4"><li>切换使用的 Node.js 版本：</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use X.Y.Z</span></span></code></pre></div><ol start="5"><li>验证版本更新，确认已经切换到了正确的 Node.js 版本</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><h2 id="pm2-启动-node-项目" tabindex="-1">pm2 启动 node 项目 <a class="header-anchor" href="#pm2-启动-node-项目" aria-label="Permalink to &quot;pm2 启动 node 项目&quot;">​</a></h2><ul><li>使用 PM2 运行 Node.js 服务是一种常见的方法，它可以帮助你管理和监控 Node.js 进程。</li><li>直接使用 node 运行服务时，在报错之后会导致 node 服务停止，pm2 则可以自动拉起应用重新运行。</li></ul><h3 id="安装-pm2" tabindex="-1">安装 pm2 <a class="header-anchor" href="#安装-pm2" aria-label="Permalink to &quot;安装 pm2&quot;">​</a></h3><ol><li><code>npm install -g pm2</code></li><li><code>rz</code>上传项目需要的文件</li><li>如果是压缩包则使用<code>unzip</code>解压</li><li><code>npm i</code>安装依赖</li><li>启动项目：<code>pm2 start xxx.js</code>或启动并设置当前项目名<code>pm2 start xxx.js --name my-node-project</code>，启动后控制台输出示例如下：</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root:/node-chatgpt-wechat#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pm2 start index.js --name node-chatgpt-wechat</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[PM2] Starting /node-chatgpt-wechat/index.js </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fork_mode (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[PM2] Done.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌────┬────────────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id │ name                   │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├────┼────────────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  │ node-chatgpt-wechat    │ default     │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.1   │ fork    │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">49505</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s     │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    │ online    │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">%       │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12.8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mb   │ root     │ disabled │</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└────┴────────────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘</span></span></code></pre></div><h3 id="pm2-常用命令" tabindex="-1">pm2 常用命令 <a class="header-anchor" href="#pm2-常用命令" aria-label="Permalink to &quot;pm2 常用命令&quot;">​</a></h3><ul><li><code>pm2 start xxx.js</code>启动 Node.js 服务</li><li><code>pm2 list</code>监控运行状态</li><li><code>pm2 logs &lt;app-name&gt;</code>查看日志</li><li><code>pm2 stop &lt;app-name&gt;</code>停止进程</li><li><code>pm2 restart &lt;appname&gt;</code> 重启</li><li><code>pm2 delete &lt;app-name&gt;</code>删除进程</li><li><code>pm2 stop all</code>停止所有进程</li><li><code>pm2 delete all</code>删除所有进程</li><li><code>pm2 update &lt;app-id-or-name&gt; --name &lt;new-name&gt;</code>修改应用程序的名称 name，app-id-or-name 是程序的 name 或 pid 值</li><li>删除日志文件：</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.pm2/logs # 进入 PM2 的日志文件目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">log-file-nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 删除日志文件</span></span></code></pre></div><h2 id="重启服务器后恢复之前的项目" tabindex="-1">重启服务器后恢复之前的项目 <a class="header-anchor" href="#重启服务器后恢复之前的项目" aria-label="Permalink to &quot;重启服务器后恢复之前的项目&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resurrect</span></span></code></pre></div>`,35),n=[l];function p(h,d,o,k,c,r){return i(),a("div",null,n)}const F=s(t,[["render",p]]);export{u as __pageData,F as default};
